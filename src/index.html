<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TimerClock</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#10B981',
                        warning: '#F59E0B',
                        danger: '#EF4444',
                        dark: '#1F2937',
                        light: '#F9FAFB'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .timer-shadow {
                box-shadow: 0 10px 25px -5px rgba(59, 130, 246, 0.1), 0 8px 10px -6px rgba(59, 130, 246, 0.1);
            }
            .glass-effect {
                backdrop-filter: blur(10px);
                background-color: rgba(255, 255, 255, 0.7);
            }
            .dark-glass {
                backdrop-filter: blur(10px);
                background-color: rgba(31, 41, 55, 0.7);
            }
            .animate-pulse-slow {
                animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite;
            }
            .scrollbar-hide::-webkit-scrollbar {
                display: none;
            }
            .scrollbar-hide {
                -ms-overflow-style: none;
                scrollbar-width: none;
            }
            .notification-panel {
                position: fixed;
                top: 20px;
                right: 20px;
                z-index: 1000;
                width: 320px;
                max-height: 80vh;
                overflow-y: auto;
            }
            .notification-item {
                animation: slideIn 0.3s ease-out;
            }
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            .notification-item.exit {
                animation: slideOut 0.3s ease-in forwards;
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
            .fullscreen-notification {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                z-index: 2000;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                background-color: rgba(0,0,0,0.85);
                animation: fadeIn 0.5s ease-out;
            }
            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }
            .fullscreen-notification.exit {
                animation: fadeOut 0.5s ease-in forwards;
            }
            @keyframes fadeOut {
                from { opacity: 1; }
                to { opacity: 0; }
            }
            .world-time-card {
                transition: all 0.3s ease;
            }
            .world-time-card:hover {
                transform: translateY(-5px);
                box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            }
            .highlight {
                background-color: rgba(59, 130, 246, 0.1);
            }
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-gray-900 dark:to-gray-800 transition-colors duration-300">
    <div class="flex flex-col min-h-screen">
        <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
        <header class="sticky top-0 z-50 glass-effect dark:dark-glass border-b border-gray-200 dark:border-gray-700">
            <div class="container mx-auto px-4 py-3 flex items-center justify-between">
                <div class="flex items-center space-x-2">
                    <i class="fa fa-clock-o text-primary dark:text-blue-400 text-2xl"></i>
                    <h1 class="text-xl font-bold text-gray-800 dark:text-white" data-i18n="appTitle">TimerClock</h1>
                </div>
                
                <div class="hidden md:flex items-center space-x-6">
                    <button id="time-date-btn" class="text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-blue-400 transition-colors">
                        <i class="fa fa-calendar-o mr-1"></i>
                        <span id="current-time">--:--:--</span>
                        <span class="mx-1">|</span>
                        <span id="current-date">----å¹´--æœˆ--æ—¥</span>
                    </button>
                    <button id="world-clock-btn" class="text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-blue-400 transition-colors">
                        <i class="fa fa-globe mr-1"></i><span data-i18n="worldClock">ä¸–ç•Œæ—¶é’Ÿ</span>
                    </button>
                    <button id="history-btn" class="text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-blue-400 transition-colors">
                        <i class="fa fa-history mr-1"></i><span data-i18n="history">å†å²</span>
                    </button>
                    <button id="notifications-btn" class="text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-blue-400 transition-colors relative">
                        <i class="fa fa-bell mr-1"></i><span data-i18n="notifications">é€šçŸ¥å’Œä¿¡æ¯</span>
                        <span id="notification-badge" class="absolute -top-1 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center hidden">0</span>
                    </button>
                    <button id="settings-btn" class="text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-blue-400 transition-colors">
                        <i class="fa fa-cog mr-1"></i><span data-i18n="settings">è®¾ç½®</span>
                    </button>
                    <button id="about-btn" class="text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-blue-400 transition-colors">
                        <i class="fa fa-info-circle mr-1"></i><span data-i18n="about">å…³äº</span>
                    </button>
                    <button id="theme-toggle" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
                        <i class="fa fa-moon-o dark:hidden text-gray-700"></i>
                        <i class="fa fa-sun-o hidden dark:inline-block text-yellow-400"></i>
                    </button>
                </div>
                
                <button id="mobile-menu-btn" class="md:hidden p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
                    <i class="fa fa-bars text-gray-700 dark:text-gray-300"></i>
                </button>
            </div>
            
            <!-- ç§»åŠ¨ç«¯èœå• -->
            <div id="mobile-menu" class="md:hidden hidden border-t border-gray-200 dark:border-gray-700">
                <div class="container mx-auto px-4 py-2 flex flex-col space-y-3">
                    <button id="mobile-time-date-btn" class="text-left text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-blue-400 transition-colors py-2">
                        <i class="fa fa-calendar-o mr-1"></i>
                        <span id="mobile-current-time">--:--:--</span>
                        <span class="mx-1">|</span>
                        <span id="mobile-current-date">----å¹´--æœˆ--æ—¥</span>
                    </button>
                    <button id="mobile-world-clock-btn" class="text-left text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-blue-400 transition-colors py-2">
                        <i class="fa fa-globe mr-1"></i><span data-i18n="worldClock">ä¸–ç•Œæ—¶é’Ÿ</span>
                    </button>
                    <button id="mobile-history-btn" class="text-left text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-blue-400 transition-colors py-2">
                        <i class="fa fa-history mr-1"></i><span data-i18n="history">å†å²è®°å½•</span>
                    </button>
                    <button id="mobile-notifications-btn" class="text-left text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-blue-400 transition-colors py-2 relative">
                        <i class="fa fa-bell mr-1"></i><span data-i18n="notifications">é€šçŸ¥å’Œä¿¡æ¯</span>
                        <span id="mobile-notification-badge" class="absolute top-3 right-0 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center hidden">0</span>
                    </button>
                    <button id="mobile-settings-btn" class="text-left text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-blue-400 transition-colors py-2">
                        <i class="fa fa-cog mr-1"></i><span data-i18n="settings">è®¾ç½®</span>
                    </button>
                    <button id="mobile-about-btn" class="text-left text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-blue-400 transition-colors py-2">
                        <i class="fa fa-info-circle mr-1"></i><span data-i18n="about">å…³äº</span>
                    </button>
                    <button id="mobile-theme-toggle" class="text-left text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-blue-400 transition-colors py-2">
                        <i class="fa fa-moon-o dark:hidden mr-1"></i>
                        <i class="fa fa-sun-o hidden dark:inline-block mr-1 text-yellow-400"></i>
                        <span class="dark:hidden" data-i18n="darkMode">æ·±è‰²æ¨¡å¼</span>
                        <span class="hidden dark:inline-block" data-i18n="lightMode">æµ…è‰²æ¨¡å¼</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- ä¸»å†…å®¹åŒº -->
        <main class="flex-grow container mx-auto px-4 py-6">
            <!-- è®¡æ—¶å™¨ç±»å‹é€‰æ‹© -->
            <div class="mb-8">
                <div class="flex flex-wrap justify-center gap-3 mb-6">
                    <button id="timer-tab" class="timer-tab-btn bg-primary text-white px-5 py-2 rounded-full shadow-md hover:shadow-lg transition-all duration-300 flex items-center">
                        <i class="fa fa-clock-o mr-2"></i><span data-i18n="countdown">å€’è®¡æ—¶</span>
                    </button>
                    <button id="stopwatch-tab" class="timer-tab-btn bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 px-5 py-2 rounded-full shadow-md hover:shadow-lg transition-all duration-300 flex items-center">
                        <i class="fa fa-hourglass-half mr-2"></i><span data-i18n="stopwatch">ç§’è¡¨</span>
                    </button>
                    <button id="alarm-tab" class="timer-tab-btn bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 px-5 py-2 rounded-full shadow-md hover:shadow-lg transition-all duration-300 flex items-center">
                        <i class="fa fa-bell-o mr-2"></i><span data-i18n="alarm">é—¹é’Ÿ</span>
                    </button>
                    <button id="countdown-day-tab" class="timer-tab-btn bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 px-5 py-2 rounded-full shadow-md hover:shadow-lg transition-all duration-300 flex items-center">
                        <i class="fa fa-calendar mr-2"></i><span data-i18n="countdownDay">å€’è®¡æ—¥</span>
                    </button>
                </div>
                
                <!-- å€’è®¡æ—¶åˆ›å»ºè¡¨å• -->
                <div id="timer-create-form" class="timer-form bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 max-w-2xl mx-auto transform transition-all duration-500">
                    <h2 class="text-xl font-bold text-gray-800 dark:text-white mb-4 flex items-center">
                        <i class="fa fa-clock-o text-primary mr-2"></i><span data-i18n="createCountdown">åˆ›å»ºå€’è®¡æ—¶</span>
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="space-y-2">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300" data-i18n="hours">å°æ—¶</label>
                            <input type="number" id="timer-hours" min="0" max="23" value="0" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:text-white focus:border-primary transition-colors">
                        </div>
                        <div class="space-y-2">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300" data-i18n="minutes">åˆ†é’Ÿ</label>
                            <input type="number" id="timer-minutes" min="0" max="59" value="0" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:text-white focus:border-primary transition-colors">
                        </div>
                        <div class="space-y-2">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300" data-i18n="seconds">ç§’</label>
                            <input type="number" id="timer-seconds" min="0" max="59" value="0" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:text-white focus:border-primary transition-colors">
                        </div>
                    </div>
                    <div class="mt-4 space-y-2">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300" data-i18n="name">åç§°</label>
                        <input type="text" id="timer-name" placeholder="è¾“å…¥å€’è®¡æ—¶åç§°" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:text-white focus:border-primary transition-colors">
                    </div>
                    <div class="mt-6 flex justify-end space-x-3">
                        <button id="cancel-timer" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors" data-i18n="cancel">
                            å–æ¶ˆ
                        </button>
                        <button id="create-timer" class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors" data-i18n="createCountdown">
                            åˆ›å»ºå€’è®¡æ—¶
                        </button>
                    </div>
                </div>
                
                <!-- ç§’è¡¨åˆ›å»ºè¡¨å• -->
                <div id="stopwatch-create-form" class="timer-form hidden bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 max-w-2xl mx-auto transform transition-all duration-500">
                    <h2 class="text-xl font-bold text-gray-800 dark:text-white mb-4 flex items-center">
                        <i class="fa fa-hourglass-half text-primary mr-2"></i><span data-i18n="createStopwatch">åˆ›å»ºç§’è¡¨</span>
                    </h2>
                    <div class="mt-4 space-y-2">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300" data-i18n="name">åç§°</label>
                        <input type="text" id="stopwatch-name" placeholder="è¾“å…¥ç§’è¡¨åç§°" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:text-white focus:border-primary transition-colors">
                    </div>
                    <div class="mt-6 flex justify-end space-x-3">
                        <button id="cancel-stopwatch" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors" data-i18n="cancel">
                            å–æ¶ˆ
                        </button>
                        <button id="create-stopwatch" class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors" data-i18n="createStopwatch">
                            åˆ›å»ºç§’è¡¨
                        </button>
                    </div>
                </div>
                
                <!-- é—¹é’Ÿåˆ›å»ºè¡¨å• -->
                <div id="alarm-create-form" class="timer-form hidden bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 max-w-2xl mx-auto transform transition-all duration-500">
                    <h2 class="text-xl font-bold text-gray-800 dark:text-white mb-4 flex items-center">
                        <i class="fa fa-bell-o text-primary mr-2"></i><span data-i18n="setAlarm">è®¾ç½®é—¹é’Ÿ</span>
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="space-y-2">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300" data-i18n="time">æ—¶é—´</label>
                            <input type="time" id="alarm-time" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:text-white focus:border-primary transition-colors">
                        </div>
                        <div class="space-y-2">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300" data-i18n="name">åç§°</label>
                            <input type="text" id="alarm-name" placeholder="è¾“å…¥é—¹é’Ÿåç§°" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:text-white focus:border-primary transition-colors">
                        </div>
                    </div>
                    <div class="mt-6 flex justify-end space-x-3">
                        <button id="cancel-alarm" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors" data-i18n="cancel">
                            å–æ¶ˆ
                        </button>
                        <button id="create-alarm" class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors" data-i18n="setAlarm">
                            è®¾ç½®é—¹é’Ÿ
                        </button>
                    </div>
                </div>
                
                <!-- å€’è®¡æ—¥åˆ›å»ºè¡¨å• -->
                <div id="countdown-day-create-form" class="timer-form hidden bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 max-w-2xl mx-auto transform transition-all duration-500">
                    <h2 class="text-xl font-bold text-gray-800 dark:text-white mb-4 flex items-center">
                        <i class="fa fa-calendar text-primary mr-2"></i><span data-i18n="createCountdownDay">åˆ›å»ºå€’è®¡æ—¥</span>
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="space-y-2">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300" data-i18n="date">æ—¥æœŸ</label>
                            <input type="date" id="countdown-day-date" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:text-white focus:border-primary transition-colors">
                        </div>
                        <div class="space-y-2">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300" data-i18n="name">åç§°</label>
                            <input type="text" id="countdown-day-name" placeholder="è¾“å…¥äº‹ä»¶åç§°" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:text-white focus:border-primary transition-colors">
                        </div>
                    </div>
                    <div class="mt-6 flex justify-end space-x-3">
                        <button id="cancel-countdown-day" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors" data-i18n="cancel">
                            å–æ¶ˆ
                        </button>
                        <button id="create-countdown-day" class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors" data-i18n="createCountdownDay">
                            åˆ›å»ºå€’è®¡æ—¥
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- è®¡æ—¶å™¨å±•ç¤ºåŒº -->
            <div id="timers-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- è®¡æ—¶å™¨å¡ç‰‡å°†åŠ¨æ€æ·»åŠ åˆ°è¿™é‡Œ -->
                <div class="text-center text-gray-500 dark:text-gray-400 py-10 col-span-full">
                    <i class="fa fa-clock-o text-5xl mb-4 opacity-30"></i>
                    <p data-i18n="noTimers">è¿˜æ²¡æœ‰ä»»ä½•è®¡æ—¶å™¨</p>
                    <p class="text-sm mt-2" data-i18n="createTimerPrompt">åˆ›å»ºä¸€ä¸ªæ–°çš„è®¡æ—¶å™¨å¼€å§‹è®¡æ—¶</p>
                </div>
            </div>
        </main>

        <!-- é¡µè„š -->
        <footer class="py-4 border-t border-gray-200 dark:border-gray-700 glass-effect dark:dark-glass">
            <div class="container mx-auto px-4 text-center text-gray-500 dark:text-gray-400 text-sm">
                <p data-i18n="footer">Â© 2025 TimerClock | é«˜æ•ˆæ—¶é—´ç®¡ç†å·¥å…·</p>
            </div>
        </footer>
    </div>

    <!-- ä¸–ç•Œæ—¶é’Ÿæ¨¡æ€æ¡† -->
    <div id="world-clock-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-4xl w-full max-h-[80vh] flex flex-col transform transition-all duration-300 scale-95 opacity-0" id="world-clock-modal-content">
            <div class="p-5 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                <h3 class="text-xl font-bold text-gray-800 dark:text-white" data-i18n="worldClock">ä¸–ç•Œæ—¶é’Ÿ</h3>
                <button id="close-world-clock" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                    <i class="fa fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-5">
                <div class="relative mb-4">
                    <input type="text" id="timezone-search" placeholder="æœç´¢æ—¶åŒº..." class="w-full px-4 py-2 pl-10 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:text-white focus:border-primary transition-colors" data-i18n-placeholder="searchPlaceholder">
                    <i class="fa fa-search absolute left-3 top-3 text-gray-400"></i>
                </div>
            </div>
            <div class="px-5 pb-5 overflow-y-auto scrollbar-hide flex-grow">
                <div id="timezones-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- æ—¶åŒºå¡ç‰‡å°†åŠ¨æ€æ·»åŠ åˆ°è¿™é‡Œ -->
                </div>
            </div>
        </div>
    </div>

    <!-- é€šçŸ¥é¢æ¿ï¼ˆå³ä¸Šè§’ï¼‰ -->
    <div id="notification-panel" class="notification-panel scrollbar-hide hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg">
            <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                <h3 class="font-bold text-gray-800 dark:text-white" data-i18n="notifications">é€šçŸ¥</h3>
                <button id="clear-notifications" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 text-sm" data-i18n="clearAll">
                    å…¨éƒ¨æ¸…é™¤
                </button>
            </div>
            <div id="notification-list" class="max-h-[60vh] overflow-y-auto">
                <!-- é€šçŸ¥å°†åŠ¨æ€æ·»åŠ åˆ°è¿™é‡Œ -->
                <div class="text-center text-gray-500 dark:text-gray-400 py-8">
                    <i class="fa fa-bell-slash text-3xl mb-3 opacity-30"></i>
                    <p data-i18n="noNotifications">æ²¡æœ‰æ–°é€šçŸ¥</p>
                </div>
            </div>
        </div>
    </div>

    <!-- å†å²è®°å½•æ¨¡æ€æ¡† -->
    <div id="history-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-4xl w-full max-h-[80vh] flex flex-col transform transition-all duration-300 scale-95 opacity-0" id="history-modal-content">
            <div class="p-5 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                <h3 class="text-xl font-bold text-gray-800 dark:text-white" data-i18n="history">å†å²è®°å½•</h3>
                <button id="close-history" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                    <i class="fa fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-5 overflow-y-auto scrollbar-hide flex-grow">
                <div id="history-records" class="space-y-4">
                    <!-- å†å²è®°å½•å°†åŠ¨æ€æ·»åŠ åˆ°è¿™é‡Œ -->
                    <div class="text-center text-gray-500 dark:text-gray-400 py-10">
                        <i class="fa fa-history text-4xl mb-3 opacity-30"></i>
                        <p data-i18n="noHistory">æš‚æ— å†å²è®°å½•</p>
                    </div>
                </div>
            </div>
            <div class="p-5 border-t border-gray-200 dark:border-gray-700 flex justify-end">
                <button id="clear-history" class="px-4 py-2 bg-danger text-white rounded-lg hover:bg-danger/90 transition-colors" data-i18n="clearHistory">
                    æ¸…ç©ºå†å²
                </button>
            </div>
        </div>
    </div>

    <!-- è®¾ç½®æ¨¡æ€æ¡† -->
    <div id="settings-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-2xl w-full transform transition-all duration-300 scale-95 opacity-0" id="settings-modal-content">
            <div class="p-5 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                <h3 class="text-xl font-bold text-gray-800 dark:text-white" data-i18n="settings">è®¾ç½®</h3>
                <button id="close-settings" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                    <i class="fa fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-5 space-y-6">
                <div>
                    <h4 class="text-lg font-medium text-gray-800 dark:text-white mb-3" data-i18n="themeSettings">ä¸»é¢˜è®¾ç½®</h4>
                    <div class="grid grid-cols-2 gap-4">
                        <button id="theme-light" class="theme-btn py-3 rounded-lg border-2 border-gray-200 dark:border-gray-700 text-center hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                            <i class="fa fa-sun-o text-yellow-500 mb-1"></i>
                            <p class="font-medium" data-i18n="lightMode">æµ…è‰²æ¨¡å¼</p>
                        </button>
                        <button id="theme-dark" class="theme-btn py-3 rounded-lg border-2 border-gray-200 dark:border-gray-700 text-center hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                            <i class="fa fa-moon-o text-blue-400 mb-1"></i>
                            <p class="font-medium" data-i18n="darkMode">æ·±è‰²æ¨¡å¼</p>
                        </button>
                    </div>
                </div>
                
                <div>
                    <h4 class="text-lg font-medium text-gray-800 dark:text-white mb-3" data-i18n="backgroundSettings">èƒŒæ™¯è®¾ç½®</h4>
                    <div class="grid grid-cols-3 gap-4">
                        <button id="bg-default" class="bg-btn h-20 rounded-lg border-2 border-gray-200 dark:border-gray-700 bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-gray-900 dark:to-gray-800 hover:opacity-80 transition-opacity"></button>
                        <button id="bg-blue" class="bg-btn h-20 rounded-lg border-2 border-gray-200 dark:border-gray-700 bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900 dark:to-blue-800 hover:opacity-80 transition-opacity"></button>
                        <button id="bg-green" class="bg-btn h-20 rounded-lg border-2 border-gray-200 dark:border-gray-700 bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900 dark:to-green-800 hover:opacity-80 transition-opacity"></button>
                        <button id="bg-purple" class="bg-btn h-20 rounded-lg border-2 border-gray-200 dark:border-gray-700 bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900 dark:to-purple-800 hover:opacity-80 transition-opacity"></button>
                        <button id="bg-red" class="bg-btn h-20 rounded-lg border-2 border-gray-200 dark:border-gray-700 bg-gradient-to-br from-red-50 to-red-100 dark:from-red-900 dark:to-red-800 hover:opacity-80 transition-opacity"></button>
                        <button id="bg-orange" class="bg-btn h-20 rounded-lg border-2 border-gray-200 dark:border-gray-700 bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900 dark:to-orange-800 hover:opacity-80 transition-opacity"></button>
                    </div>
                </div>
                
                <div>
                    <h4 class="text-lg font-medium text-gray-800 dark:text-white mb-3" data-i18n="notificationSettings">é€šçŸ¥è®¾ç½®</h4>
                    <div class="space-y-4">
                        <div class="flex items-center justify-between">
                            <label class="text-gray-700 dark:text-gray-300" data-i18n="notificationMethod">é€šçŸ¥æ–¹å¼</label>
                            <div class="flex space-x-2">
                                <button id="notification-top-right" class="notification-type-btn px-4 py-2 bg-primary text-white rounded-lg" data-i18n="topRight">
                                    å³ä¸Šè§’
                                </button>
                                <button id="notification-fullscreen" class="notification-type-btn px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg" data-i18n="fullscreen">
                                    å…¨å±
                                </button>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <label class="text-gray-700 dark:text-gray-300" data-i18n="autoSaveTimers">è‡ªåŠ¨ä¿å­˜è®¡æ—¶å™¨</label>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="auto-save" class="sr-only peer" checked>
                                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-primary rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary"></div>
                            </label>
                        </div>
                    </div>
                </div>
                
                <!-- æ–°å¢è¯­è¨€è®¾ç½® -->
                <div>
                    <h4 class="text-lg font-medium text-gray-800 dark:text-white mb-3" data-i18n="languageSettings">è¯­è¨€è®¾ç½®</h4>
                    <div class="grid grid-cols-2 gap-4">
                        <button id="lang-zh" class="lang-btn py-3 rounded-lg border-2 border-primary bg-primary/10 text-center hover:bg-primary/20 transition-colors">
                            <span class="text-xl mr-2">ğŸ‡¨ğŸ‡³</span>
                            <p class="font-medium">ç®€ä½“ä¸­æ–‡</p>
                        </button>
                        <button id="lang-en" class="lang-btn py-3 rounded-lg border-2 border-gray-200 dark:border-gray-700 text-center hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                            <span class="text-xl mr-2">ğŸ‡ºğŸ‡¸</span>
                            <p class="font-medium">English</p>
                        </button>
                    </div>
                </div>
            </div>
            <div class="p-5 border-t border-gray-200 dark:border-gray-700">
                <button id="save-settings" class="w-full py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors" data-i18n="saveSettings">
                    ä¿å­˜è®¾ç½®
                </button>
            </div>
        </div>
    </div>

    <!-- å…³äºæ¨¡æ€æ¡† -->
    <div id="about-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-md w-full transform transition-all duration-300 scale-95 opacity-0" id="about-modal-content">
            <div class="p-5 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                <h3 class="text-xl font-bold text-gray-800 dark:text-white" data-i18n="aboutTimerClock">å…³äºTimerClock</h3>
                <button id="close-about" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                    <i class="fa fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-5 space-y-4">
                <div class="text-center mb-4">
                    <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-primary/20 text-primary mb-3">
                        <i class="fa fa-clock-o text-3xl"></i>
                    </div>
                    <h4 class="text-xl font-bold text-gray-800 dark:text-white">TimerClock</h4>
                    <p class="text-gray-600 dark:text-gray-400" data-i18n="version">ç‰ˆæœ¬ 2.1.0</p>
                </div>
                
                <p class="text-gray-600 dark:text-gray-400" data-i18n="appDescription">
                    TimerClockæ˜¯ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„æ—¶é—´ç®¡ç†å·¥å…·ï¼Œæ”¯æŒå€’è®¡æ—¶ã€ç§’è¡¨ã€é—¹é’Ÿå’Œå€’è®¡æ—¥åŠŸèƒ½ã€‚æ‰€æœ‰æ•°æ®ä¿å­˜åœ¨æœ¬åœ°ï¼Œç¡®ä¿æ‚¨çš„éšç§å’Œæ•°æ®å®‰å…¨ã€‚
                </p>
                
                <div class="space-y-2">
                    <h5 class="font-medium text-gray-800 dark:text-white" data-i18n="features">åŠŸèƒ½ç‰¹ç‚¹ï¼š</h5>
                    <ul class="list-disc list-inside text-gray-600 dark:text-gray-400 space-y-1">
                        <li data-i18n="feature1">åˆ›å»ºå¤šä¸ªç‹¬ç«‹çš„å€’è®¡æ—¶ã€ç§’è¡¨ã€é—¹é’Ÿå’Œå€’è®¡æ—¥</li>
                        <li data-i18n="feature2">ä¸ºæ¯ä¸ªè®¡æ—¶å™¨å‘½åï¼Œæ–¹ä¾¿ç®¡ç†</li>
                        <li data-i18n="feature3">æœ¬åœ°ä¿å­˜è®¡æ—¶å™¨æ•°æ®ï¼Œéšæ—¶ç»§ç»­ä½¿ç”¨</li>
                        <li data-i18n="feature4">æŸ¥çœ‹è®¡æ—¶å™¨å†å²è®°å½•</li>
                        <li data-i18n="feature5">è‡ªå®šä¹‰ä¸»é¢˜å’ŒèƒŒæ™¯</li>
                        <li data-i18n="feature6">é€šçŸ¥æé†’åŠŸèƒ½</li>
                        <li data-i18n="feature7">ä¸–ç•Œæ—¶é’ŸåŠŸèƒ½</li>
                    </ul>
                </div>
            </div>
            <div class="p-5 border-t border-gray-200 dark:border-gray-700 flex justify-end space-x-3">
                <button id="author-btn" class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors" data-i18n="author">
                    ä½œè€…
                </button>
                <button id="confirm-about" class="px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors" data-i18n="confirm">
                    ç¡®å®š
                </button>
            </div>
        </div>
    </div>

    <!-- è®¡æ—¶å™¨çª—å£ -->
    <div id="timer-window" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-md w-full transform transition-all duration-300 scale-95 opacity-0" id="timer-window-content">
            <div class="p-5 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                <h3 id="window-timer-name" class="text-xl font-bold text-gray-800 dark:text-white" data-i18n="timer">è®¡æ—¶å™¨</h3>
                <button id="close-timer-window" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                    <i class="fa fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-5 text-center">
                <div id="window-timer-display" class="text-5xl font-bold text-gray-800 dark:text-white mb-6">00:00:00</div>
                
                <div class="flex justify-center space-x-3 mb-6">
                    <button id="window-timer-start" class="px-6 py-3 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors">
                        <i class="fa fa-play mr-2"></i><span data-i18n="start">å¼€å§‹</span>
                    </button>
                    <button id="window-timer-pause" class="px-6 py-3 bg-warning text-white rounded-lg hover:bg-warning/90 transition-colors hidden">
                        <i class="fa fa-pause mr-2"></i><span data-i18n="pause">æš‚åœ</span>
                    </button>
                    <button id="window-timer-reset" class="px-6 py-3 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
                        <i class="fa fa-refresh mr-2"></i><span data-i18n="reset">é‡ç½®</span>
                    </button>
                </div>
                
                <div class="flex justify-center space-x-3">
                    <button id="window-timer-delete" class="px-4 py-2 bg-danger text-white rounded-lg hover:bg-danger/90 transition-colors">
                        <i class="fa fa-trash-o mr-1"></i><span data-i18n="delete">åˆ é™¤</span>
                    </button>
                    <button id="window-timer-minimize" class="px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
                        <i class="fa fa-window-minimize mr-1"></i><span data-i18n="minimize">æœ€å°åŒ–</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- é€šçŸ¥å’Œä¿¡æ¯çª—å£ -->
    <div id="notifications-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-2xl w-full max-h-[80vh] flex flex-col transform transition-all duration-300 scale-95 opacity-0" id="notifications-modal-content">
            <div class="p-5 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                <h3 class="text-xl font-bold text-gray-800 dark:text-white" data-i18n="notificationsAndInfo">é€šçŸ¥å’Œä¿¡æ¯</h3>
                <button id="close-notifications" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                    <i class="fa fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-5 overflow-y-auto scrollbar-hide flex-grow">
                <div id="notifications-list" class="space-y-4">
                    <!-- é€šçŸ¥å°†åŠ¨æ€æ·»åŠ åˆ°è¿™é‡Œ -->
                    <div class="text-center text-gray-500 dark:text-gray-400 py-10">
                        <i class="fa fa-bell-slash text-4xl mb-3 opacity-30"></i>
                        <p data-i18n="noNotifications">æ²¡æœ‰é€šçŸ¥</p>
                        <p class="text-sm mt-2" data-i18n="notificationsHint">è®¡æ—¶å™¨ç»“æŸæ—¶å°†æ˜¾ç¤ºé€šçŸ¥</p>
                    </div>
                </div>
            </div>
            <div class="p-5 border-t border-gray-200 dark:border-gray-700 flex justify-end">
                <button id="clear-all-notifications" class="px-4 py-2 bg-danger text-white rounded-lg hover:bg-danger/90 transition-colors" data-i18n="clearAllNotifications">
                    æ¸…é™¤æ‰€æœ‰é€šçŸ¥
                </button>
            </div>
        </div>
    </div>

    <script>
        // è®¡æ—¶å™¨æ•°æ®
        let timers = [];
        let history = [];
        let notifications = [];
        let currentTimerId = null;
        let settings = {
            theme: 'system',
            background: 'default',
            autoSave: true,
            notificationType: 'top-right', // top-right æˆ– fullscreen
            language: 'zh' // é»˜è®¤è¯­è¨€
        };
        
        // å¤šè¯­è¨€å­—å…¸
        const translations = {
            zh: {
                appTitle: "TimerClock",
                worldClock: "ä¸–ç•Œæ—¶é’Ÿ",
                history: "å†å²",
                notifications: "é€šçŸ¥å’Œä¿¡æ¯",
                settings: "è®¾ç½®",
                about: "å…³äº",
                darkMode: "æ·±è‰²æ¨¡å¼",
                lightMode: "æµ…è‰²æ¨¡å¼",
                countdown: "å€’è®¡æ—¶",
                stopwatch: "ç§’è¡¨",
                alarm: "é—¹é’Ÿ",
                countdownDay: "å€’è®¡æ—¥",
                createCountdown: "åˆ›å»ºå€’è®¡æ—¶",
                hours: "å°æ—¶",
                minutes: "åˆ†é’Ÿ",
                seconds: "ç§’",
                name: "åç§°",
                cancel: "å–æ¶ˆ",
                createStopwatch: "åˆ›å»ºç§’è¡¨",
                setAlarm: "è®¾ç½®é—¹é’Ÿ",
                time: "æ—¶é—´",
                createCountdownDay: "åˆ›å»ºå€’è®¡æ—¥",
                date: "æ—¥æœŸ",
                noTimers: "è¿˜æ²¡æœ‰ä»»ä½•è®¡æ—¶å™¨",
                createTimerPrompt: "åˆ›å»ºä¸€ä¸ªæ–°çš„è®¡æ—¶å™¨å¼€å§‹è®¡æ—¶",
                footer: "Â© 2025 TimerClock | é«˜æ•ˆæ—¶é—´ç®¡ç†å·¥å…·",
                searchPlaceholder: "æœç´¢æ—¶åŒº...",
                clearAll: "å…¨éƒ¨æ¸…é™¤",
                noNotifications: "æ²¡æœ‰æ–°é€šçŸ¥",
                history: "å†å²è®°å½•",
                noHistory: "æš‚æ— å†å²è®°å½•",
                clearHistory: "æ¸…ç©ºå†å²",
                themeSettings: "ä¸»é¢˜è®¾ç½®",
                backgroundSettings: "èƒŒæ™¯è®¾ç½®",
                notificationSettings: "é€šçŸ¥è®¾ç½®",
                notificationMethod: "é€šçŸ¥æ–¹å¼",
                topRight: "å³ä¸Šè§’",
                fullscreen: "å…¨å±",
                autoSaveTimers: "è‡ªåŠ¨ä¿å­˜è®¡æ—¶å™¨",
                languageSettings: "è¯­è¨€è®¾ç½®",
                saveSettings: "ä¿å­˜è®¾ç½®",
                aboutTimerClock: "å…³äºTimerClock",
                version: "ç‰ˆæœ¬ 2.1.0",
                appDescription: "TimerClockæ˜¯ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„æ—¶é—´ç®¡ç†å·¥å…·ï¼Œæ”¯æŒå€’è®¡æ—¶ã€ç§’è¡¨ã€é—¹é’Ÿå’Œå€’è®¡æ—¥åŠŸèƒ½ã€‚æ‰€æœ‰æ•°æ®ä¿å­˜åœ¨æœ¬åœ°ï¼Œç¡®ä¿æ‚¨çš„éšç§å’Œæ•°æ®å®‰å…¨ã€‚",
                features: "åŠŸèƒ½ç‰¹ç‚¹ï¼š",
                feature1: "åˆ›å»ºå¤šä¸ªç‹¬ç«‹çš„å€’è®¡æ—¶ã€ç§’è¡¨ã€é—¹é’Ÿå’Œå€’è®¡æ—¥",
                feature2: "ä¸ºæ¯ä¸ªè®¡æ—¶å™¨å‘½åï¼Œæ–¹ä¾¿ç®¡ç†",
                feature3: "æœ¬åœ°ä¿å­˜è®¡æ—¶å™¨æ•°æ®ï¼Œéšæ—¶ç»§ç»­ä½¿ç”¨",
                feature4: "æŸ¥çœ‹è®¡æ—¶å™¨å†å²è®°å½•",
                feature5: "è‡ªå®šä¹‰ä¸»é¢˜å’ŒèƒŒæ™¯",
                feature6: "é€šçŸ¥æé†’åŠŸèƒ½",
                feature7: "ä¸–ç•Œæ—¶é’ŸåŠŸèƒ½",
                author: "ä½œè€…",
                confirm: "ç¡®å®š",
                timer: "è®¡æ—¶å™¨",
                start: "å¼€å§‹",
                pause: "æš‚åœ",
                reset: "é‡ç½®",
                delete: "åˆ é™¤",
                minimize: "æœ€å°åŒ–",
                notificationsAndInfo: "é€šçŸ¥å’Œä¿¡æ¯",
                notificationsHint: "è®¡æ—¶å™¨ç»“æŸæ—¶å°†æ˜¾ç¤ºé€šçŸ¥",
                clearAllNotifications: "æ¸…é™¤æ‰€æœ‰é€šçŸ¥"
            },
            en: {
                appTitle: "TimerClock",
                worldClock: "World Clock",
                history: "History",
                notifications: "Notifications & Info",
                settings: "Settings",
                about: "About",
                darkMode: "Dark Mode",
                lightMode: "Light Mode",
                countdown: "Countdown",
                stopwatch: "Stopwatch",
                alarm: "Alarm",
                countdownDay: "Countdown Day",
                createCountdown: "Create Countdown",
                hours: "Hours",
                minutes: "Minutes",
                seconds: "Seconds",
                name: "Name",
                cancel: "Cancel",
                createStopwatch: "Create Stopwatch",
                setAlarm: "Set Alarm",
                time: "Time",
                createCountdownDay: "Create Countdown Day",
                date: "Date",
                noTimers: "No timers yet",
                createTimerPrompt: "Create a new timer to start",
                footer: "Â© 2025 TimerClock | Efficient Time Management Tool",
                searchPlaceholder: "Search timezones...",
                clearAll: "Clear All",
                noNotifications: "No new notifications",
                history: "History",
                noHistory: "No history yet",
                clearHistory: "Clear History",
                themeSettings: "Theme Settings",
                backgroundSettings: "Background Settings",
                notificationSettings: "Notification Settings",
                notificationMethod: "Notification Method",
                topRight: "Top Right",
                fullscreen: "Fullscreen",
                autoSaveTimers: "Auto Save Timers",
                languageSettings: "Language Settings",
                saveSettings: "Save Settings",
                aboutTimerClock: "About TimerClock",
                version: "Version 2.1.0",
                appDescription: "TimerClock is a powerful time management tool that supports countdowns, stopwatches, alarms, and day counters. All data is saved locally to ensure your privacy and data security.",
                features: "Features:",
                feature1: "Create multiple independent timers, stopwatches, alarms, and day counters",
                feature2: "Name each timer for easy management",
                feature3: "Save timer data locally to continue anytime",
                feature4: "View timer history records",
                feature5: "Customize themes and backgrounds",
                feature6: "Notification reminder function",
                feature7: "World clock feature",
                author: "Author",
                confirm: "OK",
                timer: "Timer",
                start: "Start",
                pause: "Pause",
                reset: "Reset",
                delete: "Delete",
                minimize: "Minimize",
                notificationsAndInfo: "Notifications & Information",
                notificationsHint: "Notifications will appear when timers end",
                clearAllNotifications: "Clear All Notifications"
            }
        };
        
        // å¸¸ç”¨æ—¶åŒºåˆ—è¡¨
        const timezones = [
            { id: "Asia/Shanghai", name: "ä¸­å›½æ—¶é—´ (åŒ—äº¬)", city: "Beijing" },
            { id: "Asia/Tokyo", name: "æ—¥æœ¬æ—¶é—´ (ä¸œäº¬)", city: "Tokyo" },
            { id: "America/New_York", name: "ç¾å›½ä¸œéƒ¨æ—¶é—´ (çº½çº¦)", city: "New York" },
            { id: "America/Los_Angeles", name: "ç¾å›½å¤ªå¹³æ´‹æ—¶é—´ (æ´›æ‰çŸ¶)", city: "Los Angeles" },
            { id: "Europe/London", name: "æ ¼æ—å°¼æ²»æ ‡å‡†æ—¶é—´ (ä¼¦æ•¦)", city: "London" },
            { id: "Europe/Paris", name: "æ¬§æ´²ä¸­éƒ¨æ—¶é—´ (å·´é»)", city: "Paris" },
            { id: "Europe/Berlin", name: "æ¬§æ´²ä¸­éƒ¨æ—¶é—´ (æŸæ—)", city: "Berlin" },
            { id: "Australia/Sydney", name: "æ¾³å¤§åˆ©äºšä¸œéƒ¨æ—¶é—´ (æ‚‰å°¼)", city: "Sydney" },
            { id: "Asia/Dubai", name: "æµ·æ¹¾æ ‡å‡†æ—¶é—´ (è¿ªæ‹œ)", city: "Dubai" },
            { id: "Asia/Singapore", name: "æ–°åŠ å¡æ—¶é—´", city: "Singapore" },
            { id: "Asia/Hong_Kong", name: "é¦™æ¸¯æ—¶é—´", city: "Hong Kong" },
            { id: "Asia/Seoul", name: "éŸ©å›½æ—¶é—´ (é¦–å°”)", city: "Seoul" },
            { id: "Asia/Kolkata", name: "å°åº¦æ ‡å‡†æ—¶é—´ (æ–°å¾·é‡Œ)", city: "New Delhi" },
            { id: "Asia/Bangkok", name: "æ³°å›½æ—¶é—´ (æ›¼è°·)", city: "Bangkok" },
            { id: "America/Toronto", name: "åŠ æ‹¿å¤§ä¸œéƒ¨æ—¶é—´ (å¤šä¼¦å¤š)", city: "Toronto" },
            { id: "America/Chicago", name: "ç¾å›½ä¸­éƒ¨æ—¶é—´ (èŠåŠ å“¥)", city: "Chicago" },
            { id: "Pacific/Auckland", name: "æ–°è¥¿å…°æ—¶é—´ (å¥¥å…‹å…°)", city: "Auckland" },
            { id: "Africa/Johannesburg", name: "å—éæ ‡å‡†æ—¶é—´ (çº¦ç¿°å†…æ–¯å ¡)", city: "Johannesburg" },
            { id: "Asia/Jerusalem", name: "ä»¥è‰²åˆ—æ—¶é—´ (è€¶è·¯æ’’å†·)", city: "Jerusalem" },
            { id: "Asia/Riyadh", name: "é˜¿æ‹‰ä¼¯æ ‡å‡†æ—¶é—´ (åˆ©é›…å¾—)", city: "Riyadh" }
        ];
        
        // DOMå…ƒç´ 
        const timerTabBtn = document.getElementById('timer-tab');
        const stopwatchTabBtn = document.getElementById('stopwatch-tab');
        const alarmTabBtn = document.getElementById('alarm-tab');
        const countdownDayTabBtn = document.getElementById('countdown-day-tab');
        
        const timerCreateForm = document.getElementById('timer-create-form');
        const stopwatchCreateForm = document.getElementById('stopwatch-create-form');
        const alarmCreateForm = document.getElementById('alarm-create-form');
        const countdownDayCreateForm = document.getElementById('countdown-day-create-form');
        
        const timersContainer = document.getElementById('timers-container');
        const historyRecords = document.getElementById('history-records');
        const notificationsList = document.getElementById('notifications-list');
        
        // æ¨¡æ€æ¡†
        const worldClockModal = document.getElementById('world-clock-modal');
        const worldClockModalContent = document.getElementById('world-clock-modal-content');
        const historyModal = document.getElementById('history-modal');
        const historyModalContent = document.getElementById('history-modal-content');
        const settingsModal = document.getElementById('settings-modal');
        const settingsModalContent = document.getElementById('settings-modal-content');
        const aboutModal = document.getElementById('about-modal');
        const aboutModalContent = document.getElementById('about-modal-content');
        const timerWindow = document.getElementById('timer-window');
        const timerWindowContent = document.getElementById('timer-window-content');
        const notificationsModal = document.getElementById('notifications-modal');
        const notificationsModalContent = document.getElementById('notifications-modal-content');
        const notificationPanel = document.getElementById('notification-panel');
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            loadFromLocalStorage();
            updateTimersDisplay();
            updateHistoryDisplay();
            updateNotificationsDisplay();
            updateDateTime();
            setInterval(updateDateTime, 1000);
            applySettings();
            setupEventListeners();
            updateWorldClock(); // åˆå§‹åŒ–ä¸–ç•Œæ—¶é’Ÿæ˜¾ç¤º
            setInterval(updateWorldClock, 1000); // æ¯ç§’æ›´æ–°ä¸–ç•Œæ—¶é’Ÿ
        });
        
        // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
        function setupEventListeners() {
            // æ ‡ç­¾åˆ‡æ¢
            timerTabBtn.addEventListener('click', () => switchTab('timer'));
            stopwatchTabBtn.addEventListener('click', () => switchTab('stopwatch'));
            alarmTabBtn.addEventListener('click', () => switchTab('alarm'));
            countdownDayTabBtn.addEventListener('click', () => switchTab('countdown-day'));
            
            // è¡¨å•æäº¤
            document.getElementById('create-timer').addEventListener('click', createTimer);
            document.getElementById('cancel-timer').addEventListener('click', () => clearForm('timer'));
            document.getElementById('create-stopwatch').addEventListener('click', createStopwatch);
            document.getElementById('cancel-stopwatch').addEventListener('click', () => clearForm('stopwatch'));
            document.getElementById('create-alarm').addEventListener('click', createAlarm);
            document.getElementById('cancel-alarm').addEventListener('click', () => clearForm('alarm'));
            document.getElementById('create-countdown-day').addEventListener('click', createCountdownDay);
            document.getElementById('cancel-countdown-day').addEventListener('click', () => clearForm('countdown-day'));
            
            // ä¸–ç•Œæ—¶é’Ÿæ§åˆ¶
            document.getElementById('world-clock-btn').addEventListener('click', openWorldClockModal);
            document.getElementById('mobile-world-clock-btn').addEventListener('click', openWorldClockModal);
            document.getElementById('close-world-clock').addEventListener('click', closeWorldClockModal);
            document.getElementById('timezone-search').addEventListener('input', searchTimezones);
            
            // å†å²è®°å½•æ§åˆ¶
            document.getElementById('history-btn').addEventListener('click', openHistoryModal);
            document.getElementById('mobile-history-btn').addEventListener('click', openHistoryModal);
            document.getElementById('close-history').addEventListener('click', closeHistoryModal);
            document.getElementById('clear-history').addEventListener('click', clearHistory);
            
            // è®¾ç½®æ§åˆ¶
            document.getElementById('settings-btn').addEventListener('click', openSettingsModal);
            document.getElementById('mobile-settings-btn').addEventListener('click', openSettingsModal);
            document.getElementById('close-settings').addEventListener('click', closeSettingsModal);
            document.getElementById('save-settings').addEventListener('click', saveSettings);
            
            // è¯­è¨€åˆ‡æ¢
            document.getElementById('lang-zh').addEventListener('click', () => setLanguage('zh'));
            document.getElementById('lang-en').addEventListener('click', () => setLanguage('en'));
            
            // å…³äºæ§åˆ¶
            document.getElementById('about-btn').addEventListener('click', openAboutModal);
            document.getElementById('mobile-about-btn').addEventListener('click', openAboutModal);
            document.getElementById('close-about').addEventListener('click', closeAboutModal);
            document.getElementById('confirm-about').addEventListener('click', closeAboutModal);
            document.getElementById('author-btn').addEventListener('click', () => {
                window.open('https://space.bilibili.com/3546730406611340', '_blank');
            });
            
            // é€šçŸ¥æ§åˆ¶
            document.getElementById('notifications-btn').addEventListener('click', openNotificationsModal);
            document.getElementById('mobile-notifications-btn').addEventListener('click', openNotificationsModal);
            document.getElementById('close-notifications').addEventListener('click', closeNotificationsModal);
            document.getElementById('clear-all-notifications').addEventListener('click', clearAllNotifications);
            document.getElementById('clear-notifications').addEventListener('click', clearAllNotifications);
            
            // ä¸»é¢˜åˆ‡æ¢
            document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
            document.getElementById('mobile-theme-toggle').addEventListener('click', toggleTheme);
            
            // ç§»åŠ¨ç«¯èœå•
            document.getElementById('mobile-menu-btn').addEventListener('click', toggleMobileMenu);
            
            // è®¾ç½®ä¸­çš„ä¸»é¢˜å’ŒèƒŒæ™¯é€‰æ‹©
            document.getElementById('theme-light').addEventListener('click', () => setTheme('light'));
            document.getElementById('theme-dark').addEventListener('click', () => setTheme('dark'));
            document.getElementById('bg-default').addEventListener('click', () => setBackground('default'));
            document.getElementById('bg-blue').addEventListener('click', () => setBackground('blue'));
            document.getElementById('bg-green').addEventListener('click', () => setBackground('green'));
            document.getElementById('bg-purple').addEventListener('click', () => setBackground('purple'));
            document.getElementById('bg-red').addEventListener('click', () => setBackground('red'));
            document.getElementById('bg-orange').addEventListener('click', () => setBackground('orange'));
            
            // é€šçŸ¥æ–¹å¼é€‰æ‹©
            document.getElementById('notification-top-right').addEventListener('click', () => setNotificationType('top-right'));
            document.getElementById('notification-fullscreen').addEventListener('click', () => setNotificationType('fullscreen'));
            
            // è®¡æ—¶å™¨çª—å£æ§åˆ¶
            document.getElementById('close-timer-window').addEventListener('click', closeTimerWindow);
            document.getElementById('window-timer-start').addEventListener('click', startWindowTimer);
            document.getElementById('window-timer-pause').addEventListener('click', pauseWindowTimer);
            document.getElementById('window-timer-reset').addEventListener('click', resetWindowTimer);
            document.getElementById('window-timer-delete').addEventListener('click', deleteWindowTimer);
            document.getElementById('window-timer-minimize').addEventListener('click', minimizeWindowTimer);
        }
        
        // æ‰“å¼€ä¸–ç•Œæ—¶é’Ÿæ¨¡æ€æ¡†
        function openWorldClockModal() {
            worldClockModal.classList.remove('hidden');
            setTimeout(() => {
                worldClockModalContent.classList.remove('scale-95', 'opacity-0');
                worldClockModalContent.classList.add('scale-100', 'opacity-100');
            }, 10);
        }
        
        // å…³é—­ä¸–ç•Œæ—¶é’Ÿæ¨¡æ€æ¡†
        function closeWorldClockModal() {
            worldClockModalContent.classList.remove('scale-100', 'opacity-100');
            worldClockModalContent.classList.add('scale-95', 'opacity-0');
            setTimeout(() => {
                worldClockModal.classList.add('hidden');
            }, 300);
        }
        
        // æ›´æ–°ä¸–ç•Œæ—¶é’Ÿæ˜¾ç¤º
        function updateWorldClock() {
            const timezonesContainer = document.getElementById('timezones-container');
            if (!timezonesContainer) return;
            
            timezonesContainer.innerHTML = '';
            
            timezones.forEach(tz => {
                const card = document.createElement('div');
                card.className = 'world-time-card bg-white dark:bg-gray-800 rounded-lg p-4 hover:shadow-md transition-shadow';
                
                const now = new Date();
                const options = {
                    timeZone: tz.id,
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit',
                    hour12: settings.language === 'en'
                };
                
                const timeString = new Intl.DateTimeFormat(settings.language === 'en' ? 'en-US' : 'zh-CN', options).format(now);
                const dateOptions = {
                    timeZone: tz.id,
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                };
                
                const dateString = new Intl.DateTimeFormat(settings.language === 'en' ? 'en-US' : 'zh-CN', dateOptions).format(now);
                
                card.innerHTML = `
                    <div class="flex items-center mb-3">
                        <i class="fa fa-globe text-primary mr-2"></i>
                        <h4 class="font-bold text-gray-800 dark:text-white">${tz.name}</h4>
                    </div>
                    <div class="text-2xl font-bold text-gray-800 dark:text-white mb-2">${timeString}</div>
                    <div class="text-sm text-gray-600 dark:text-gray-400">${dateString}</div>
                `;
                
                timezonesContainer.appendChild(card);
            });
        }
        
        // æœç´¢æ—¶åŒº
        function searchTimezones() {
            const searchTerm = document.getElementById('timezone-search').value.toLowerCase();
            const timezonesContainer = document.getElementById('timezones-container');
            if (!timezonesContainer) return;
            
            const cards = timezonesContainer.querySelectorAll('.world-time-card');
            cards.forEach(card => {
                const tzName = card.querySelector('h4').textContent.toLowerCase();
                const shouldShow = tzName.includes(searchTerm);
                card.style.display = shouldShow ? 'block' : 'none';
                
                // é«˜äº®æ˜¾ç¤ºåŒ¹é…éƒ¨åˆ†
                if (shouldShow && searchTerm) {
                    const regex = new RegExp(`(${searchTerm})`, 'gi');
                    const highlightedName = tzName.replace(regex, '<span class="highlight">$1</span>');
                    card.querySelector('h4').innerHTML = card.querySelector('h4').innerHTML.replace(tzName, highlightedName);
                }
            });
        }
        
        // è®¾ç½®è¯­è¨€
        function setLanguage(lang) {
            settings.language = lang;
            applyTranslations();
            saveToLocalStorage();
            
            // æ›´æ–°UI
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('border-primary', 'bg-primary/10');
                btn.classList.add('border-gray-200', 'dark:border-gray-700');
            });
            document.getElementById(`lang-${lang}`).classList.remove('border-gray-200', 'dark:border-gray-700');
            document.getElementById(`lang-${lang}`).classList.add('border-primary', 'bg-primary/10');
        }
        
        // åº”ç”¨ç¿»è¯‘
        function applyTranslations() {
            const lang = settings.language;
            const translation = translations[lang];
            
            // æ›´æ–°æ‰€æœ‰å¸¦æœ‰ data-i18n å±æ€§çš„å…ƒç´ 
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (translation[key]) {
                    el.textContent = translation[key];
                }
            });
            
            // æ›´æ–°æ‰€æœ‰å¸¦æœ‰ data-i18n-placeholder å±æ€§çš„å…ƒç´ 
            document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                const key = el.getAttribute('data-i18n-placeholder');
                if (translation[key]) {
                    el.placeholder = translation[key];
                }
            });
            
            // æ›´æ–°æ—¥æœŸæ—¶é—´æ˜¾ç¤º
            updateDateTime();
        }
        
        // åˆ‡æ¢æ ‡ç­¾
        function switchTab(tabName) {
            // é‡ç½®æ‰€æœ‰æ ‡ç­¾æŒ‰é’®æ ·å¼
            [timerTabBtn, stopwatchTabBtn, alarmTabBtn, countdownDayTabBtn].forEach(btn => {
                btn.classList.remove('bg-primary', 'text-white');
                btn.classList.add('bg-white', 'dark:bg-gray-800', 'text-gray-700', 'dark:text-gray-300');
            });
            
            // è®¾ç½®å½“å‰æ ‡ç­¾æŒ‰é’®æ ·å¼
            const currentBtn = document.getElementById(`${tabName}-tab`);
            currentBtn.classList.remove('bg-white', 'dark:bg-gray-800', 'text-gray-700', 'dark:text-gray-300');
            currentBtn.classList.add('bg-primary', 'text-white');
            
            // éšè—æ‰€æœ‰è¡¨å•
            [timerCreateForm, stopwatchCreateForm, alarmCreateForm, countdownDayCreateForm].forEach(form => {
                form.classList.add('hidden');
            });
            
            // æ˜¾ç¤ºå½“å‰è¡¨å•
            const currentForm = document.getElementById(`${tabName}-create-form`);
            currentForm.classList.remove('hidden');
            
            // æ¸…é™¤å½“å‰è¡¨å•
            clearForm(tabName);
        }
        
        // æ¸…é™¤è¡¨å•
        function clearForm(formType) {
            switch(formType) {
                case 'timer':
                    document.getElementById('timer-hours').value = '0';
                    document.getElementById('timer-minutes').value = '0';
                    document.getElementById('timer-seconds').value = '0';
                    document.getElementById('timer-name').value = '';
                    break;
                case 'stopwatch':
                    document.getElementById('stopwatch-name').value = '';
                    break;
                case 'alarm':
                    document.getElementById('alarm-time').value = '';
                    document.getElementById('alarm-name').value = '';
                    break;
                case 'countdown-day':
                    document.getElementById('countdown-day-date').value = '';
                    document.getElementById('countdown-day-name').value = '';
                    break;
            }
        }
        
        // åˆ›å»ºå€’è®¡æ—¶
        function createTimer() {
            const hours = parseInt(document.getElementById('timer-hours').value) || 0;
            const minutes = parseInt(document.getElementById('timer-minutes').value) || 0;
            const seconds = parseInt(document.getElementById('timer-seconds').value) || 0;
            const name = document.getElementById('timer-name').value || translations[settings.language].countdown;
            
            if (hours === 0 && minutes === 0 && seconds === 0) {
                alert(settings.language === 'zh' ? 'è¯·è®¾ç½®æœ‰æ•ˆçš„æ—¶é—´!' : 'Please set a valid time!');
                return;
            }
            
            const totalSeconds = hours * 3600 + minutes * 60 + seconds;
            
            const newTimer = {
                id: Date.now().toString(),
                type: 'timer',
                name,
                totalSeconds,
                remainingSeconds: totalSeconds,
                isRunning: false,
                createdAt: new Date().toISOString()
            };
            
            timers.push(newTimer);
            updateTimersDisplay();
            saveToLocalStorage();
            clearForm('timer');
            
            // è‡ªåŠ¨æ‰“å¼€è®¡æ—¶å™¨çª—å£
            openTimerWindow(newTimer.id);
        }
        
        // åˆ›å»ºç§’è¡¨
        function createStopwatch() {
            const name = document.getElementById('stopwatch-name').value || translations[settings.language].stopwatch;
            
            const newStopwatch = {
                id: Date.now().toString(),
                type: 'stopwatch',
                name,
                totalSeconds: 0,
                isRunning: false,
                createdAt: new Date().toISOString()
            };
            
            timers.push(newStopwatch);
            updateTimersDisplay();
            saveToLocalStorage();
            clearForm('stopwatch');
            
            // è‡ªåŠ¨æ‰“å¼€è®¡æ—¶å™¨çª—å£
            openTimerWindow(newStopwatch.id);
        }
        
        // åˆ›å»ºé—¹é’Ÿ
        function createAlarm() {
            const time = document.getElementById('alarm-time').value;
            const name = document.getElementById('alarm-name').value || translations[settings.language].alarm;
            
            if (!time) {
                alert(settings.language === 'zh' ? 'è¯·é€‰æ‹©æœ‰æ•ˆçš„æ—¶é—´!' : 'Please select a valid time!');
                return;
            }
            
            const [hours, minutes] = time.split(':').map(Number);
            const now = new Date();
            const alarmDate = new Date(now.getFullYear(), now.getMonth(), now.getDate(), hours, minutes, 0);
            
            // å¦‚æœè®¾ç½®çš„æ—¶é—´å·²ç»è¿‡äº†ï¼Œè®¾ç½®ä¸ºæ˜å¤©
            if (alarmDate <= now) {
                alarmDate.setDate(alarmDate.getDate() + 1);
            }
            
            const totalSeconds = Math.floor((alarmDate - now) / 1000);
            
            const newAlarm = {
                id: Date.now().toString(),
                type: 'alarm',
                name,
                totalSeconds,
                remainingSeconds: totalSeconds,
                isRunning: false,
                alarmTime: alarmDate.toISOString(),
                createdAt: new Date().toISOString()
            };
            
            timers.push(newAlarm);
            updateTimersDisplay();
            saveToLocalStorage();
            clearForm('alarm');
            
            // è‡ªåŠ¨æ‰“å¼€è®¡æ—¶å™¨çª—å£
            openTimerWindow(newAlarm.id);
        }
        
        // åˆ›å»ºå€’è®¡æ—¥
        function createCountdownDay() {
            const date = document.getElementById('countdown-day-date').value;
            const name = document.getElementById('countdown-day-name').value || translations[settings.language].countdownDay;
            
            if (!date) {
                alert(settings.language === 'zh' ? 'è¯·é€‰æ‹©æœ‰æ•ˆçš„æ—¥æœŸ!' : 'Please select a valid date!');
                return;
            }
            
            const targetDate = new Date(date);
            const now = new Date();
            
            // è®¾ç½®ç›®æ ‡æ—¶é—´ä¸ºå½“å¤©çš„23:59:59
            targetDate.setHours(23, 59, 59, 999);
            
            const timeDiff = targetDate - now;
            if (timeDiff <= 0) {
                alert(settings.language === 'zh' ? 'è¯·é€‰æ‹©æœªæ¥çš„æ—¥æœŸ!' : 'Please select a future date!');
                return;
            }
            
            const totalSeconds = Math.floor(timeDiff / 1000);
            
            const newCountdownDay = {
                id: Date.now().toString(),
                type: 'countdown-day',
                name,
                totalSeconds,
                remainingSeconds: totalSeconds,
                isRunning: false,
                targetDate: targetDate.toISOString(),
                createdAt: new Date().toISOString()
            };
            
            timers.push(newCountdownDay);
            updateTimersDisplay();
            saveToLocalStorage();
            clearForm('countdown-day');
            
            // è‡ªåŠ¨æ‰“å¼€è®¡æ—¶å™¨çª—å£
            openTimerWindow(newCountdownDay.id);
        }
        
        // æ›´æ–°è®¡æ—¶å™¨æ˜¾ç¤º
        function updateTimersDisplay() {
            timersContainer.innerHTML = '';
            
            if (timers.length === 0) {
                timersContainer.innerHTML = `
                    <div class="text-center text-gray-500 dark:text-gray-400 py-10 col-span-full">
                        <i class="fa fa-clock-o text-5xl mb-4 opacity-30"></i>
                        <p>${translations[settings.language].noTimers}</p>
                        <p class="text-sm mt-2">${translations[settings.language].createTimerPrompt}</p>
                    </div>
                `;
                return;
            }
            
            timers.forEach(timer => {
                const card = document.createElement('div');
                card.className = 'bg-white dark:bg-gray-800 rounded-xl shadow-lg p-5 transform transition-all duration-300 hover:shadow-xl timer-shadow';
                
                let timeDisplay = '';
                let timerIcon = '';
                
                switch(timer.type) {
                    case 'timer':
                        timerIcon = 'fa-clock-o';
                        timeDisplay = formatTime(timer.remainingSeconds);
                        break;
                    case 'stopwatch':
                        timerIcon = 'fa-hourglass-half';
                        timeDisplay = formatTime(timer.totalSeconds);
                        break;
                    case 'alarm':
                        timerIcon = 'fa-bell-o';
                        timeDisplay = formatTime(timer.remainingSeconds);
                        break;
                    case 'countdown-day':
                        timerIcon = 'fa-calendar';
                        const days = Math.floor(timer.remainingSeconds / (3600 * 24));
                        timeDisplay = `${days} ${translations[settings.language].days || 'å¤©'}`;
                        break;
                }
                
                card.innerHTML = `
                    <div class="flex justify-between items-start mb-4">
                        <div class="flex items-center">
                            <i class="fa ${timerIcon} text-primary mr-2"></i>
                            <h3 class="font-bold text-gray-800 dark:text-white">${timer.name}</h3>
                        </div>
                        <div class="flex space-x-1">
                            <button class="edit-timer p-1 text-gray-500 hover:text-primary transition-colors" data-id="${timer.id}">
                                <i class="fa fa-pencil"></i>
                            </button>
                            <button class="delete-timer p-1 text-gray-500 hover:text-danger transition-colors" data-id="${timer.id}">
                                <i class="fa fa-trash-o"></i>
                            </button>
                        </div>
                    </div>
                    <div class="text-center mb-4">
                        <div class="text-3xl font-bold text-gray-800 dark:text-white">${timeDisplay}</div>
                    </div>
                    <div class="flex justify-center space-x-2">
                        <button class="start-timer px-3 py-1.5 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors ${timer.isRunning ? 'hidden' : ''}" data-id="${timer.id}">
                            <i class="fa fa-play mr-1"></i>${translations[settings.language].start}
                        </button>
                        <button class="pause-timer px-3 py-1.5 bg-warning text-white rounded-lg hover:bg-warning/90 transition-colors ${!timer.isRunning ? 'hidden' : ''}" data-id="${timer.id}">
                            <i class="fa fa-pause mr-1"></i>${translations[settings.language].pause}
                        </button>
                        <button class="open-timer px-3 py-1.5 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors" data-id="${timer.id}">
                            <i class="fa fa-expand mr-1"></i>${translations[settings.language].open || 'æ‰“å¼€'}
                        </button>
                    </div>
                `;
                
                timersContainer.appendChild(card);
                
                // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
                card.querySelector('.start-timer').addEventListener('click', (e) => {
                    const id = e.currentTarget.getAttribute('data-id');
                    startTimer(id);
                });
                
                card.querySelector('.pause-timer').addEventListener('click', (e) => {
                    const id = e.currentTarget.getAttribute('data-id');
                    pauseTimer(id);
                });
                
                card.querySelector('.open-timer').addEventListener('click', (e) => {
                    const id = e.currentTarget.getAttribute('data-id');
                    openTimerWindow(id);
                });
                
                card.querySelector('.delete-timer').addEventListener('click', (e) => {
                    const id = e.currentTarget.getAttribute('data-id');
                    deleteTimer(id);
                });
                
                card.querySelector('.edit-timer').addEventListener('click', (e) => {
                    const id = e.currentTarget.getAttribute('data-id');
                    editTimer(id);
                });
            });
        }
        
        // æ ¼å¼åŒ–æ—¶é—´
        function formatTime(seconds) {
            if (seconds < 0) seconds = 0;
            
            const hours = Math.floor(seconds / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            const secs = seconds % 60;
            
            return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }
        
        // å¼€å§‹è®¡æ—¶å™¨
        function startTimer(id) {
            const timer = timers.find(t => t.id === id);
            if (!timer || timer.isRunning) return;
            
            timer.isRunning = true;
            updateTimersDisplay();
            saveToLocalStorage();
            
            if (timer.type === 'stopwatch') {
                // ç§’è¡¨é€»è¾‘
                const startTime = Date.now() - (timer.totalSeconds * 1000);
                
                timer.interval = setInterval(() => {
                    const now = Date.now();
                    timer.totalSeconds = Math.floor((now - startTime) / 1000);
                    
                    if (id === currentTimerId) {
                        document.getElementById('window-timer-display').textContent = formatTime(timer.totalSeconds);
                    }
                    
                    updateTimersDisplay();
                    saveToLocalStorage();
                }, 1000);
            } else {
                // å€’è®¡æ—¶å’Œé—¹é’Ÿé€»è¾‘
                timer.interval = setInterval(() => {
                    timer.remainingSeconds--;
                    
                    if (timer.remainingSeconds <= 0) {
                        clearInterval(timer.interval);
                        timer.isRunning = false;
                        
                        // æ·»åŠ åˆ°å†å²è®°å½•
                        addToHistory(timer.name, timer.type, translations[settings.language].completed || 'å®Œæˆ');
                        
                        // æ’­æ”¾æç¤ºéŸ³
                        playAlarmSound();
                        
                        // æ˜¾ç¤ºé€šçŸ¥
                        showCustomNotification(timer.name, timer.type);
                    }
                    
                    if (id === currentTimerId) {
                        document.getElementById('window-timer-display').textContent = formatTime(timer.remainingSeconds);
                    }
                    
                    updateTimersDisplay();
                    saveToLocalStorage();
                }, 1000);
            }
        }
        
        // æš‚åœè®¡æ—¶å™¨
        function pauseTimer(id) {
            const timer = timers.find(t => t.id === id);
            if (!timer || !timer.isRunning) return;
            
            clearInterval(timer.interval);
            timer.isRunning = false;
            updateTimersDisplay();
            saveToLocalStorage();
        }
        
        // æ‰“å¼€è®¡æ—¶å™¨çª—å£
        function openTimerWindow(id) {
            const timer = timers.find(t => t.id === id);
            if (!timer) return;
            
            currentTimerId = id;
            
            document.getElementById('window-timer-name').textContent = timer.name;
            
            if (timer.type === 'stopwatch') {
                document.getElementById('window-timer-display').textContent = formatTime(timer.totalSeconds);
            } else {
                document.getElementById('window-timer-display').textContent = formatTime(timer.remainingSeconds);
            }
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            if (timer.isRunning) {
                document.getElementById('window-timer-start').classList.add('hidden');
                document.getElementById('window-timer-pause').classList.remove('hidden');
            } else {
                document.getElementById('window-timer-start').classList.remove('hidden');
                document.getElementById('window-timer-pause').classList.add('hidden');
            }
            
            // æ˜¾ç¤ºçª—å£
            timerWindow.classList.remove('hidden');
            setTimeout(() => {
                timerWindowContent.classList.remove('scale-95', 'opacity-0');
                timerWindowContent.classList.add('scale-100', 'opacity-100');
            }, 10);
        }
        
        // å…³é—­è®¡æ—¶å™¨çª—å£
        function closeTimerWindow() {
            timerWindowContent.classList.remove('scale-100', 'opacity-100');
            timerWindowContent.classList.add('scale-95', 'opacity-0');
            setTimeout(() => {
                timerWindow.classList.add('hidden');
                currentTimerId = null;
            }, 300);
        }
        
        // å¼€å§‹çª—å£ä¸­çš„è®¡æ—¶å™¨
        function startWindowTimer() {
            if (!currentTimerId) return;
            startTimer(currentTimerId);
        }
        
        // æš‚åœçª—å£ä¸­çš„è®¡æ—¶å™¨
        function pauseWindowTimer() {
            if (!currentTimerId) return;
            pauseTimer(currentTimerId);
        }
        
        // é‡ç½®çª—å£ä¸­çš„è®¡æ—¶å™¨
        function resetWindowTimer() {
            if (!currentTimerId) return;
            
            const timer = timers.find(t => t.id === currentTimerId);
            if (!timer) return;
            
            // å…ˆæš‚åœè®¡æ—¶å™¨
            if (timer.isRunning) {
                pauseTimer(currentTimerId);
            }
            
            // é‡ç½®æ—¶é—´
            if (timer.type === 'stopwatch') {
                timer.totalSeconds = 0;
            } else {
                timer.remainingSeconds = timer.totalSeconds;
            }
            
            // æ›´æ–°æ˜¾ç¤º
            if (timer.type === 'stopwatch') {
                document.getElementById('window-timer-display').textContent = formatTime(timer.totalSeconds);
            } else {
                document.getElementById('window-timer-display').textContent = formatTime(timer.remainingSeconds);
            }
            
            updateTimersDisplay();
            saveToLocalStorage();
        }
        
        // åˆ é™¤çª—å£ä¸­çš„è®¡æ—¶å™¨
        function deleteWindowTimer() {
            if (!currentTimerId) return;
            
            if (confirm(settings.language === 'zh' ? 'ç¡®å®šè¦åˆ é™¤è¿™ä¸ªè®¡æ—¶å™¨å—ï¼Ÿ' : 'Are you sure you want to delete this timer?')) {
                deleteTimer(currentTimerId);
                closeTimerWindow();
            }
        }
        
        // æœ€å°åŒ–çª—å£ä¸­çš„è®¡æ—¶å™¨
        function minimizeWindowTimer() {
            closeTimerWindow();
        }
        
        // åˆ é™¤è®¡æ—¶å™¨
        function deleteTimer(id) {
            const timerIndex = timers.findIndex(t => t.id === id);
            if (timerIndex === -1) return;
            
            // å…ˆæš‚åœè®¡æ—¶å™¨
            const timer = timers[timerIndex];
            if (timer.isRunning) {
                clearInterval(timer.interval);
            }
            
            // æ·»åŠ åˆ°å†å²è®°å½•
            addToHistory(timer.name, timer.type, translations[settings.language].deleted || 'å·²åˆ é™¤');
            
            // ä»æ•°ç»„ä¸­åˆ é™¤
            timers.splice(timerIndex, 1);
            
            // æ›´æ–°æ˜¾ç¤º
            updateTimersDisplay();
            saveToLocalStorage();
        }
        
        // ç¼–è¾‘è®¡æ—¶å™¨
        function editTimer(id) {
            const timer = timers.find(t => t.id === id);
            if (!timer) return;
            
            // å…ˆæš‚åœè®¡æ—¶å™¨
            if (timer.isRunning) {
                pauseTimer(id);
            }
            
            // æ ¹æ®è®¡æ—¶å™¨ç±»å‹æ˜¾ç¤ºç›¸åº”çš„è¡¨å•
            switch(timer.type) {
                case 'timer':
                    switchTab('timer');
                    document.getElementById('timer-hours').value = Math.floor(timer.totalSeconds / 3600);
                    document.getElementById('timer-minutes').value = Math.floor((timer.totalSeconds % 3600) / 60);
                    document.getElementById('timer-seconds').value = timer.totalSeconds % 60;
                    document.getElementById('timer-name').value = timer.name;
                    break;
                case 'stopwatch':
                    switchTab('stopwatch');
                    document.getElementById('stopwatch-name').value = timer.name;
                    break;
                case 'alarm':
                    switchTab('alarm');
                    const alarmDate = new Date(timer.alarmTime);
                    const hours = alarmDate.getHours().toString().padStart(2, '0');
                    const minutes = alarmDate.getMinutes().toString().padStart(2, '0');
                    document.getElementById('alarm-time').value = `${hours}:${minutes}`;
                    document.getElementById('alarm-name').value = timer.name;
                    break;
                case 'countdown-day':
                    switchTab('countdown-day');
                    const targetDate = new Date(timer.targetDate);
                    const dateString = targetDate.toISOString().split('T')[0];
                    document.getElementById('countdown-day-date').value = dateString;
                    document.getElementById('countdown-day-name').value = timer.name;
                    break;
            }
            
            // åˆ é™¤æ—§çš„è®¡æ—¶å™¨
            deleteTimer(id);
        }
        
        // æ·»åŠ åˆ°å†å²è®°å½•
        function addToHistory(name, type, status) {
            const historyItem = {
                id: Date.now().toString(),
                name,
                type,
                status,
                time: new Date().toISOString()
            };
            
            history.unshift(historyItem); // æ·»åŠ åˆ°æ•°ç»„å¼€å¤´
            
            // é™åˆ¶å†å²è®°å½•æ•°é‡
            if (history.length > 50) {
                history.pop();
            }
            
            updateHistoryDisplay();
            saveToLocalStorage();
        }
        
        // æ›´æ–°å†å²è®°å½•æ˜¾ç¤º
        function updateHistoryDisplay() {
            historyRecords.innerHTML = '';
            
            if (history.length === 0) {
                historyRecords.innerHTML = `
                    <div class="text-center text-gray-500 dark:text-gray-400 py-10">
                        <i class="fa fa-history text-4xl mb-3 opacity-30"></i>
                        <p>${translations[settings.language].noHistory}</p>
                    </div>
                `;
                return;
            }
            
            history.forEach(item => {
                const record = document.createElement('div');
                record.className = 'bg-white dark:bg-gray-800 rounded-lg p-4 hover:shadow-md transition-shadow';
                
                let typeIcon = '';
                let statusClass = '';
                
                switch(item.type) {
                    case 'timer':
                        typeIcon = 'fa-clock-o';
                        break;
                    case 'stopwatch':
                        typeIcon = 'fa-hourglass-half';
                        break;
                    case 'alarm':
                        typeIcon = 'fa-bell-o';
                        break;
                    case 'countdown-day':
                        typeIcon = 'fa-calendar';
                        break;
                }
                
                switch(item.status) {
                    case translations[settings.language].completed || 'å®Œæˆ':
                        statusClass = 'text-green-500';
                        break;
                    case translations[settings.language].deleted || 'å·²åˆ é™¤':
                        statusClass = 'text-gray-500';
                        break;
                }
                
                const time = new Date(item.time);
                const timeString = time.toLocaleString(settings.language === 'en' ? 'en-US' : 'zh-CN');
                
                record.innerHTML = `
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <i class="fa ${typeIcon} text-primary mr-2"></i>
                            <span class="font-medium text-gray-800 dark:text-white">${item.name}</span>
                        </div>
                        <span class="text-sm ${statusClass}">${item.status}</span>
                    </div>
                    <div class="text-sm text-gray-500 dark:text-gray-400 mt-1">
                        ${timeString}
                    </div>
                `;
                
                historyRecords.appendChild(record);
            });
        }
        
        // æ¸…ç©ºå†å²è®°å½•
        function clearHistory() {
            if (confirm(settings.language === 'zh' ? 'ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å†å²è®°å½•å—ï¼Ÿ' : 'Are you sure you want to clear all history?')) {
                history = [];
                updateHistoryDisplay();
                saveToLocalStorage();
            }
        }
        
        // æ‰“å¼€å†å²è®°å½•æ¨¡æ€æ¡†
        function openHistoryModal() {
            historyModal.classList.remove('hidden');
            setTimeout(() => {
                historyModalContent.classList.remove('scale-95', 'opacity-0');
                historyModalContent.classList.add('scale-100', 'opacity-100');
            }, 10);
        }
        
        // å…³é—­å†å²è®°å½•æ¨¡æ€æ¡†
        function closeHistoryModal() {
            historyModalContent.classList.remove('scale-100', 'opacity-100');
            historyModalContent.classList.add('scale-95', 'opacity-0');
            setTimeout(() => {
                historyModal.classList.add('hidden');
            }, 300);
        }
        
        // æ·»åŠ é€šçŸ¥
        function addNotification(name, type) {
            const notification = {
                id: Date.now().toString(),
                name,
                type,
                time: new Date().toISOString(),
                read: false
            };
            
            notifications.unshift(notification); // æ·»åŠ åˆ°æ•°ç»„å¼€å¤´
            
            // é™åˆ¶é€šçŸ¥æ•°é‡
            if (notifications.length > 50) {
                notifications.pop();
            }
            
            // æ›´æ–°é€šçŸ¥æ˜¾ç¤º
            updateNotificationsDisplay();
            
            // æ›´æ–°é€šçŸ¥å¾½ç« 
            updateNotificationBadge();
            
            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
            saveToLocalStorage();
            
            // æ˜¾ç¤ºé€šçŸ¥
            showCustomNotification(name, type);
        }
        
        // æ›´æ–°é€šçŸ¥æ˜¾ç¤º
        function updateNotificationsDisplay() {
            notificationsList.innerHTML = '';
            
            if (notifications.length === 0) {
                notificationsList.innerHTML = `
                    <div class="text-center text-gray-500 dark:text-gray-400 py-10">
                        <i class="fa fa-bell-slash text-4xl mb-3 opacity-30"></i>
                        <p>${translations[settings.language].noNotifications}</p>
                        <p class="text-sm mt-2">${translations[settings.language].notificationsHint}</p>
                    </div>
                `;
                return;
            }
            
            notifications.forEach(notification => {
                const notif = document.createElement('div');
                notif.className = `bg-white dark:bg-gray-800 rounded-lg p-4 hover:shadow-md transition-shadow ${notification.read ? '' : 'border-l-4 border-primary'}`;
                
                let typeIcon = '';
                let typeText = '';
                
                switch(notification.type) {
                    case 'timer':
                        typeIcon = 'fa-clock-o';
                        typeText = translations[settings.language].countdown;
                        break;
                    case 'stopwatch':
                        typeIcon = 'fa-hourglass-half';
                        typeText = translations[settings.language].stopwatch;
                        break;
                    case 'alarm':
                        typeIcon = 'fa-bell-o';
                        typeText = translations[settings.language].alarm;
                        break;
                    case 'countdown-day':
                        typeIcon = 'fa-calendar';
                        typeText = translations[settings.language].countdownDay;
                        break;
                }
                
                const time = new Date(notification.time);
                const timeString = time.toLocaleString(settings.language === 'en' ? 'en-US' : 'zh-CN');
                
                notif.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div>
                            <div class="flex items-center">
                                <i class="fa ${typeIcon} text-primary mr-2"></i>
                                <span class="font-medium text-gray-800 dark:text-white">${notification.name}</span>
                            </div>
                            <div class="text-sm text-gray-500 dark:text-gray-400 mt-1">
                                <span class="bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded">${typeText}</span>
                                <span class="ml-2">${timeString}</span>
                            </div>
                        </div>
                        <button class="delete-notification text-gray-400 hover:text-danger transition-colors" data-id="${notification.id}">
                            <i class="fa fa-times"></i>
                        </button>
                    </div>
                `;
                
                notificationsList.appendChild(notif);
                
                // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
                notif.querySelector('.delete-notification').addEventListener('click', (e) => {
                    e.stopPropagation();
                    const id = e.currentTarget.getAttribute('data-id');
                    deleteNotification(id);
                });
                
                // æ ‡è®°ä¸ºå·²è¯»
                notif.addEventListener('click', () => {
                    notification.read = true;
                    updateNotificationsDisplay();
                    saveToLocalStorage();
                    updateNotificationBadge();
                });
            });
        }
        
        // åˆ é™¤é€šçŸ¥
        function deleteNotification(id) {
            const index = notifications.findIndex(n => n.id === id);
            if (index !== -1) {
                notifications.splice(index, 1);
                updateNotificationsDisplay();
                updateNotificationBadge();
                saveToLocalStorage();
            }
        }
        
        // æ¸…é™¤æ‰€æœ‰é€šçŸ¥
        function clearAllNotifications() {
            if (confirm(settings.language === 'zh' ? 'ç¡®å®šè¦æ¸…é™¤æ‰€æœ‰é€šçŸ¥å—ï¼Ÿ' : 'Are you sure you want to clear all notifications?')) {
                notifications = [];
                updateNotificationsDisplay();
                updateNotificationBadge();
                saveToLocalStorage();
            }
        }
        
        // æ›´æ–°é€šçŸ¥å¾½ç« 
        function updateNotificationBadge() {
            const unreadCount = notifications.filter(n => !n.read).length;
            const badge = document.getElementById('notification-badge');
            const mobileBadge = document.getElementById('mobile-notification-badge');
            
            if (unreadCount > 0) {
                badge.textContent = unreadCount;
                badge.classList.remove('hidden');
                mobileBadge.textContent = unreadCount;
                mobileBadge.classList.remove('hidden');
            } else {
                badge.classList.add('hidden');
                mobileBadge.classList.add('hidden');
            }
        }
        
        // æ‰“å¼€é€šçŸ¥çª—å£
        function openNotificationsModal() {
            notificationsModal.classList.remove('hidden');
            setTimeout(() => {
                notificationsModalContent.classList.remove('scale-95', 'opacity-0');
                notificationsModalContent.classList.add('scale-100', 'opacity-100');
            }, 10);
            
            // æ ‡è®°æ‰€æœ‰é€šçŸ¥ä¸ºå·²è¯»
            notifications.forEach(n => n.read = true);
            updateNotificationBadge();
            saveToLocalStorage();
        }
        
        // å…³é—­é€šçŸ¥çª—å£
        function closeNotificationsModal() {
            notificationsModalContent.classList.remove('scale-100', 'opacity-100');
            notificationsModalContent.classList.add('scale-95', 'opacity-0');
            setTimeout(() => {
                notificationsModal.classList.add('hidden');
            }, 300);
        }
        
        // æ˜¾ç¤ºè‡ªå®šä¹‰é€šçŸ¥
        function showCustomNotification(name, type) {
            const notification = {
                id: Date.now().toString(),
                name,
                type,
                time: new Date().toISOString()
            };
            
            // æ ¹æ®è®¾ç½®æ˜¾ç¤ºä¸åŒç±»å‹çš„é€šçŸ¥
            if (settings.notificationType === 'top-right') {
                showTopRightNotification(notification);
            } else {
                showFullscreenNotification(notification);
            }
        }
        
        // æ˜¾ç¤ºå³ä¸Šè§’é€šçŸ¥
        function showTopRightNotification(notification) {
            // ç¡®ä¿é€šçŸ¥é¢æ¿å¯è§
            notificationPanel.classList.remove('hidden');
            
            const notifItem = document.createElement('div');
            notifItem.className = 'notification-item bg-white dark:bg-gray-800 rounded-lg p-4 mb-3 shadow-lg cursor-pointer';
            notifItem.dataset.id = notification.id;
            
            let typeIcon = '';
            let typeText = '';
            
            switch(notification.type) {
                case 'timer':
                    typeIcon = 'fa-clock-o';
                    typeText = translations[settings.language].countdown;
                    break;
                case 'stopwatch':
                    typeIcon = 'fa-hourglass-half';
                    typeText = translations[settings.language].stopwatch;
                    break;
                case 'alarm':
                    typeIcon = 'fa-bell-o';
                    typeText = translations[settings.language].alarm;
                    break;
                case 'countdown-day':
                    typeIcon = 'fa-calendar';
                    typeText = translations[settings.language].countdownDay;
                    break;
            }
            
            const time = new Date();
            const timeString = time.toLocaleTimeString(settings.language === 'en' ? 'en-US' : 'zh-CN');
            
            notifItem.innerHTML = `
                <div class="flex items-start">
                    <div class="flex-shrink-0">
                        <div class="w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center text-primary">
                            <i class="fa ${typeIcon}"></i>
                        </div>
                    </div>
                    <div class="ml-3 flex-1">
                        <p class="text-sm font-medium text-gray-900 dark:text-white">${notification.name}</p>
                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">${typeText} - ${timeString}</p>
                    </div>
                    <button class="close-notification text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 ml-2">
                        <i class="fa fa-times"></i>
                    </button>
                </div>
            `;
            
            // æ·»åŠ åˆ°é€šçŸ¥é¢æ¿çš„å¼€å¤´
            const notificationList = document.getElementById('notification-list');
            if (notificationList.children.length > 0 && 
                notificationList.children[0].classList.contains('text-center')) {
                notificationList.innerHTML = '';
            }
            notificationList.insertBefore(notifItem, notificationList.firstChild);
            
            // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
            notifItem.querySelector('.close-notification').addEventListener('click', (e) => {
                e.stopPropagation();
                notifItem.classList.add('exit');
                setTimeout(() => {
                    notifItem.remove();
                    if (document.getElementById('notification-list').children.length === 0) {
                        notificationList.innerHTML = `
                            <div class="text-center text-gray-500 dark:text-gray-400 py-8">
                                <i class="fa fa-bell-slash text-3xl mb-3 opacity-30"></i>
                                <p>${translations[settings.language].noNotifications}</p>
                            </div>
                        `;
                    }
                }, 300);
            });
            
            // ç‚¹å‡»é€šçŸ¥
            notifItem.addEventListener('click', () => {
                addNotification(notification.name, notification.type);
                notifItem.remove();
                if (document.getElementById('notification-list').children.length === 0) {
                    notificationList.innerHTML = `
                        <div class="text-center text-gray-500 dark:text-gray-400 py-8">
                            <i class="fa fa-bell-slash text-3xl mb-3 opacity-30"></i>
                            <p>${translations[settings.language].noNotifications}</p>
                        </div>
                    `;
                }
            });
            
            // è‡ªåŠ¨ç§»é™¤é€šçŸ¥
            setTimeout(() => {
                if (notifItem.parentNode) {
                    notifItem.classList.add('exit');
                    setTimeout(() => {
                        notifItem.remove();
                        if (document.getElementById('notification-list').children.length === 0) {
                            notificationList.innerHTML = `
                                <div class="text-center text-gray-500 dark:text-gray-400 py-8">
                                    <i class="fa fa-bell-slash text-3xl mb-3 opacity-30"></i>
                                    <p>${translations[settings.language].noNotifications}</p>
                                </div>
                            `;
                        }
                    }, 300);
                }
            }, 5000);
        }
        
        // æ˜¾ç¤ºå…¨å±é€šçŸ¥
        function showFullscreenNotification(notification) {
            const fullscreenNotif = document.createElement('div');
            fullscreenNotif.className = 'fullscreen-notification';
            fullscreenNotif.dataset.id = notification.id;
            
            let typeIcon = '';
            let typeText = '';
            
            switch(notification.type) {
                case 'timer':
                    typeIcon = 'fa-clock-o';
                    typeText = translations[settings.language].countdown;
                    break;
                case 'stopwatch':
                    typeIcon = 'fa-hourglass-half';
                    typeText = translations[settings.language].stopwatch;
                    break;
                case 'alarm':
                    typeIcon = 'fa-bell-o';
                    typeText = translations[settings.language].alarm;
                    break;
                case 'countdown-day':
                    typeIcon = 'fa-calendar';
                    typeText = translations[settings.language].countdownDay;
                    break;
            }
            
            fullscreenNotif.innerHTML = `
                <div class="text-center text-white p-8 max-w-md">
                    <div class="inline-flex items-center justify-center w-20 h-20 rounded-full bg-white/10 mb-6">
                        <i class="fa ${typeIcon} text-white text-3xl"></i>
                    </div>
                    <h2 class="text-3xl font-bold mb-2">${notification.name}</h2>
                    <p class="text-xl mb-8">${typeText} ${settings.language === 'zh' ? 'æ—¶é—´åˆ°!' : 'Time is up!'}</p>
                    <div class="flex justify-center">
                        <button id="dismiss-notification" class="px-6 py-3 bg-white text-gray-800 rounded-lg font-medium hover:bg-gray-100 transition-colors">
                            ${settings.language === 'zh' ? 'å…³é—­' : 'Dismiss'}
                        </button>
                        <button id="save-notification" class="px-6 py-3 bg-primary text-white rounded-lg font-medium hover:bg-primary/90 ml-4 transition-colors">
                            ${settings.language === 'zh' ? 'ä¿å­˜é€šçŸ¥' : 'Save Notification'}
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(fullscreenNotif);
            
            // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
            fullscreenNotif.querySelector('#dismiss-notification').addEventListener('click', () => {
                fullscreenNotif.classList.add('exit');
                setTimeout(() => {
                    fullscreenNotif.remove();
                }, 500);
            });
            
            fullscreenNotif.querySelector('#save-notification').addEventListener('click', () => {
                addNotification(notification.name, notification.type);
                fullscreenNotif.classList.add('exit');
                setTimeout(() => {
                    fullscreenNotif.remove();
                }, 500);
            });
        }
        
        // æ‰“å¼€è®¾ç½®æ¨¡æ€æ¡†
        function openSettingsModal() {
            // è®¾ç½®å½“å‰é€‰ä¸­çš„ä¸»é¢˜
            if (settings.theme === 'light') {
                document.getElementById('theme-light').classList.add('border-primary');
                document.getElementById('theme-dark').classList.remove('border-primary');
            } else {
                document.getElementById('theme-light').classList.remove('border-primary');
                document.getElementById('theme-dark').classList.add('border-primary');
            }
            
            // è®¾ç½®å½“å‰é€‰ä¸­çš„èƒŒæ™¯
            document.querySelectorAll('.bg-btn').forEach(btn => {
                btn.classList.remove('border-primary');
            });
            document.getElementById(`bg-${settings.background}`).classList.add('border-primary');
            
            // è®¾ç½®é€šçŸ¥æ–¹å¼
            document.querySelectorAll('.notification-type-btn').forEach(btn => {
                btn.classList.remove('bg-primary', 'text-white');
                btn.classList.add('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
            });
            document.getElementById(`notification-${settings.notificationType}`).classList.remove('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
            document.getElementById(`notification-${settings.notificationType}`).classList.add('bg-primary', 'text-white');
            
            // è®¾ç½®è¯­è¨€é€‰é¡¹
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('border-primary', 'bg-primary/10');
                btn.classList.add('border-gray-200', 'dark:border-gray-700');
            });
            document.getElementById(`lang-${settings.language}`).classList.add('border-primary', 'bg-primary/10');
            
            // è®¾ç½®è‡ªåŠ¨ä¿å­˜é€‰é¡¹
            document.getElementById('auto-save').checked = settings.autoSave;
            
            settingsModal.classList.remove('hidden');
            setTimeout(() => {
                settingsModalContent.classList.remove('scale-95', 'opacity-0');
                settingsModalContent.classList.add('scale-100', 'opacity-100');
            }, 10);
        }
        
        // å…³é—­è®¾ç½®æ¨¡æ€æ¡†
        function closeSettingsModal() {
            settingsModalContent.classList.remove('scale-100', 'opacity-100');
            settingsModalContent.classList.add('scale-95', 'opacity-0');
            setTimeout(() => {
                settingsModal.classList.add('hidden');
            }, 300);
        }
        
        // ä¿å­˜è®¾ç½®
        function saveSettings() {
            saveToLocalStorage();
            applySettings();
            closeSettingsModal();
        }
        
        // è®¾ç½®ä¸»é¢˜
        function setTheme(theme) {
            settings.theme = theme;
            
            // æ›´æ–°UI
            document.querySelectorAll('.theme-btn').forEach(btn => {
                btn.classList.remove('border-primary');
            });
            document.getElementById(`theme-${theme}`).classList.add('border-primary');
        }
        
        // è®¾ç½®èƒŒæ™¯
        function setBackground(background) {
            settings.background = background;
            
            // æ›´æ–°UI
            document.querySelectorAll('.bg-btn').forEach(btn => {
                btn.classList.remove('border-primary');
            });
            document.getElementById(`bg-${background}`).classList.add('border-primary');
        }
        
        // è®¾ç½®é€šçŸ¥ç±»å‹
        function setNotificationType(type) {
            settings.notificationType = type;
            
            // æ›´æ–°UI
            document.querySelectorAll('.notification-type-btn').forEach(btn => {
                btn.classList.remove('bg-primary', 'text-white');
                btn.classList.add('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
            });
            document.getElementById(`notification-${type}`).classList.remove('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
            document.getElementById(`notification-${type}`).classList.add('bg-primary', 'text-white');
        }
        
        // åˆ‡æ¢ä¸»é¢˜
        function toggleTheme() {
            settings.theme = settings.theme === 'light' ? 'dark' : 'light';
            applySettings();
            saveToLocalStorage();
        }
        
        // åº”ç”¨è®¾ç½®
        function applySettings() {
            // åº”ç”¨ä¸»é¢˜
            if (settings.theme === 'light' || (settings.theme === 'system' && window.matchMedia('(prefers-color-scheme: light)').matches)) {
                document.documentElement.classList.remove('dark');
            } else {
                document.documentElement.classList.add('dark');
            }
            
            // åº”ç”¨èƒŒæ™¯
            const body = document.body;
            body.classList.remove(
                'bg-gradient-to-br', 'from-blue-50', 'to-indigo-50', 
                'from-blue-50', 'to-blue-100', 
                'from-green-50', 'to-green-100', 
                'from-purple-50', 'to-purple-100', 
                'from-red-50', 'to-red-100', 
                'from-orange-50', 'to-orange-100',
                'dark:from-gray-900', 'dark:to-gray-800',
                'dark:from-blue-900', 'dark:to-blue-800',
                'dark:from-green-900', 'dark:to-green-800',
                'dark:from-purple-900', 'dark:to-purple-800',
                'dark:from-red-900', 'dark:to-red-800',
                'dark:from-orange-900', 'dark:to-orange-800'
            );
            
            switch(settings.background) {
                case 'default':
                    body.classList.add('bg-gradient-to-br', 'from-blue-50', 'to-indigo-50', 'dark:from-gray-900', 'dark:to-gray-800');
                    break;
                case 'blue':
                    body.classList.add('bg-gradient-to-br', 'from-blue-50', 'to-blue-100', 'dark:from-blue-900', 'dark:to-blue-800');
                    break;
                case 'green':
                    body.classList.add('bg-gradient-to-br', 'from-green-50', 'to-green-100', 'dark:from-green-900', 'dark:to-green-800');
                    break;
                case 'purple':
                    body.classList.add('bg-gradient-to-br', 'from-purple-50', 'to-purple-100', 'dark:from-purple-900', 'dark:to-purple-800');
                    break;
                case 'red':
                    body.classList.add('bg-gradient-to-br', 'from-red-50', 'to-red-100', 'dark:from-red-900', 'dark:to-red-800');
                    break;
                case 'orange':
                    body.classList.add('bg-gradient-to-br', 'from-orange-50', 'to-orange-100', 'dark:from-orange-900', 'dark:to-orange-800');
                    break;
            }
            
            // åº”ç”¨è‡ªåŠ¨ä¿å­˜è®¾ç½®
            settings.autoSave = document.getElementById('auto-save').checked;
            
            // åº”ç”¨è¯­è¨€è®¾ç½®
            applyTranslations();
        }
        
        // åˆ‡æ¢ç§»åŠ¨ç«¯èœå•
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenu.classList.toggle('hidden');
        }
        
        // æ‰“å¼€å…³äºæ¨¡æ€æ¡†
        function openAboutModal() {
            aboutModal.classList.remove('hidden');
            setTimeout(() => {
                aboutModalContent.classList.remove('scale-95', 'opacity-0');
                aboutModalContent.classList.add('scale-100', 'opacity-100');
            }, 10);
        }
        
        // å…³é—­å…³äºæ¨¡æ€æ¡†
        function closeAboutModal() {
            aboutModalContent.classList.remove('scale-100', 'opacity-100');
            aboutModalContent.classList.add('scale-95', 'opacity-0');
            setTimeout(() => {
                aboutModal.classList.add('hidden');
            }, 300);
        }
        
        // æ›´æ–°æ—¥æœŸæ—¶é—´æ˜¾ç¤º
        function updateDateTime() {
            const now = new Date();
            
            // æ ¼å¼åŒ–æ—¶é—´
            const options = {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: settings.language === 'en'
            };
            
            const timeString = now.toLocaleTimeString(settings.language === 'en' ? 'en-US' : 'zh-CN', options);
            
            // æ ¼å¼åŒ–æ—¥æœŸ
            const dateOptions = {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit'
            };
            
            let dateString = now.toLocaleDateString(settings.language === 'en' ? 'en-US' : 'zh-CN', dateOptions);
            
            // ä¸­æ–‡æ ¼å¼è°ƒæ•´
            if (settings.language === 'zh') {
                dateString = dateString.replace(/\//g, 'å¹´').replace(/\//g, 'æœˆ') + 'æ—¥';
            }
            
            // æ›´æ–°UI
            document.getElementById('current-time').textContent = timeString;
            document.getElementById('current-date').textContent = dateString;
            document.getElementById('mobile-current-time').textContent = timeString;
            document.getElementById('mobile-current-date').textContent = dateString;
        }
        
        // ä¿å­˜æ•°æ®åˆ°æœ¬åœ°å­˜å‚¨
        function saveToLocalStorage() {
            if (!settings.autoSave) return;
            
            const data = {
                timers: timers.map(timer => {
                    // ä¸è¦ä¿å­˜interval
                    return {
                        ...timer,
                        interval: undefined
                    };
                }),
                history,
                notifications,
                settings
            };
            
            localStorage.setItem('timerAppData', JSON.stringify(data));
        }
        
        // ä»æœ¬åœ°å­˜å‚¨åŠ è½½æ•°æ®
        function loadFromLocalStorage() {
            const data = localStorage.getItem('timerAppData');
            if (!data) return;
            
            try {
                const parsedData = JSON.parse(data);
                
                if (parsedData.timers) {
                    timers = parsedData.timers;
                    
                    // æ¸…é™¤æ‰€æœ‰interval
                    timers.forEach(timer => {
                        timer.interval = undefined;
                    });
                }
                
                if (parsedData.history) {
                    history = parsedData.history;
                }
                
                if (parsedData.notifications) {
                    notifications = parsedData.notifications;
                    updateNotificationBadge();
                }
                
                if (parsedData.settings) {
                    settings = parsedData.settings;
                }
            } catch (e) {
                console.error('Failed to load data from localStorage:', e);
            }
        }
        
        // æ’­æ”¾æç¤ºéŸ³
        function playAlarmSound() {
            // ç®€å•çš„æç¤ºéŸ³å®ç°
            const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(440, audioCtx.currentTime); // 440 Hz (A4)
            oscillator.frequency.exponentialRampToValueAtTime(
                880, audioCtx.currentTime + 0.5
            ); // å‡è‡³880 Hz (A5)
            
            gainNode.gain.setValueAtTime(0, audioCtx.currentTime);
            gainNode.gain.linearRampToValueAtTime(1, audioCtx.currentTime + 0.05);
            gainNode.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.5);
            
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            oscillator.start();
            oscillator.stop(audioCtx.currentTime + 0.5);
        }
    </script>
</body>
</html>